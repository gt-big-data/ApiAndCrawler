<html>
	<head>
		<style>
		#map {
			height: 400px;
			width: 100%;
		}
		</style>
	</head>
	<body>

		<div id="map"></div>

		<script>

            var coords = [];
            var markers = [];
            var counter = 0;

            function resetButton(reset, map) {
                var controlUI = document.createElement('div');
                controlUI.style.backgroundColor = '#fff';
                controlUI.style.border = '2px solid #fff';
                controlUI.style.borderRadius = '3px';
                controlUI.style.boxShadow = '0 2px 6px rgba(0,0,0,.3)';
                controlUI.style.cursor = 'pointer';
                controlUI.style.marginBottom = '22px';
                controlUI.style.textAlign = 'center';
                controlUI.title = 'Click to recenter the map';
                reset.appendChild(controlUI);

                // Set CSS for the control interior.
                var controlText = document.createElement('div');
                controlText.style.color = 'rgb(25,25,25)';
                controlText.style.fontFamily = 'Roboto,Arial,sans-serif';
                controlText.style.fontSize = '10px';
                controlText.style.lineHeight = '28px';
                controlText.style.paddingLeft = '7px';
                controlText.style.paddingRight = '7px';
                controlText.innerHTML = 'Reset';
                controlUI.appendChild(controlText);

                controlUI.addEventListener('click', function() {
                    deleteMarkers();
                    counter = 0;

                    if (rect != null) {
                        rect.setMap(null);
                        rect = null;     
                    }
                });

            }

			function initMap() {
                var uluru = {lat: 39.731879, lng: -101.614792};
                var map = new google.maps.Map(document.getElementById('map'), {
                  zoom: 4,
                  center: uluru
                });
                var resetMarkerDiv = document.createElement('div');
                var resetMarker = new resetButton(resetMarkerDiv, map);

                resetMarkerDiv.index = 1;
                map.controls[google.maps.ControlPosition.TOP_RIGHT].push(resetMarkerDiv);

                google.maps.event.addListener(map, 'click', function(event) {
                    counter = counter + 1;
                    if (counter > 2 && counter % 2 != 0) {
                        deleteMarkers();
                        rect.setMap(null);
                        rect = null;
                    }
                    coords.push(event.latLng);
                    console.log(coords);
                	returnCoords(map, event.latLng);
                    
                    if (counter % 2 == 0) {
                        if(coords[0].lng() < coords[1].lng()) {
                            rect = new google.maps.Rectangle({
                                map: map,
                                bounds: new google.maps.LatLngBounds(coords[0], coords[1])
                            }); 
                        } else if (coords[0].lng() > coords[1].lng()) {
                            rect = new google.maps.Rectangle({
                                map: map,
                                bounds: new google.maps.LatLngBounds(coords[1], coords[0])
                            });
                        }
                    }
                });
            }

            function returnCoords(map, location) {
            	var marker = new google.maps.Marker({
            		position: location,
            		map: map
            	});
            	var infowindow = new google.maps.InfoWindow({
            		content: 'Latitude: ' + location.lat() + '<br>Longitude: ' + location.lng()
            	});
            	infowindow.open(map,marker);
                markers.push(marker);
            }

            function setMapOnAll(map) {
                for (var i = 0; i < markers.length; i++) {
                    markers[i].setMap(map);
                }
            }

            function deleteMarkers() {
                setMapOnAll(null);
                markers = [];
                coords = [];
            }

        </script>

        <script async defer
            src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCAbE03GnNDUJ2udV-GdQk7BxhauZcYkAk&callback=initMap">
            </script>
	</body>
</html>